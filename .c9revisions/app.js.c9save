{"ts":1360568990554,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1360568998863,"patch":[[{"diffs":[[1,"\r\n\r\nvar radio = require('./radio-stream')\r\nvar http = require('http')\r\n\r\n\r\nhttp.get('http://api.jok.ge/musicchannel/0/getall', function (res) {\r\n\r\n    var st = '';\r\n\r\n    res.on('data', function (data) {\r\n        st += data;\r\n    });\r\n\r\n    res.on('end', function () {\r\n        var channels = JSON.parse(st);\r\n\r\n        console.log('Channels loaded: ', channels.length);\r\n\r\n        for (var i = 0; i < channels.length; i++) {\r\n            CreateStream(channels[i].ID, channels[i].Source);\r\n        }\r\n    });\r\n});\r\n\r\nfunction CreateStream(id, url) {\r\n    var stream = radio.createReadStream(url);\r\n\r\n    stream.on(\"metadata\", function (metadata) {\r\n\r\n        var title = radio.parseMetadata(metadata).StreamTitle;\r\n        if (!title || title == '') return;\r\n\r\n        http.get('http://api.jok.ge/musicchannel/' + id + '/addtrack?info=' + title);\r\n    });\r\n\r\n    stream.on(\"error\", function (error) {\r\n        console.log(id, error);\r\n    });\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":945}]],"length":945,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360571357338,"patch":[[{"diffs":[[0,"tp')\r\n\r\n"],[1,"var channelsCount = 0;\r\n"],[0,"\r\nhttp.g"]],"start1":65,"start2":65,"length1":16,"length2":40},{"diffs":[[0," error);\r\n    });\r\n}"],[1,"\r\n\r\n"]],"start1":949,"start2":949,"length1":20,"length2":24}]],"length":973,"saved":false}
{"ts":1360571378810,"patch":[[{"diffs":[[0,"s.length);\r\n"],[1,"        channelsCount = channels.length;\r\n        "],[0,"\r\n        fo"]],"start1":384,"start2":384,"length1":24,"length2":74}]],"length":1023,"saved":false}
{"ts":1360571460931,"patch":[[{"diffs":[[0,"  });\r\n}\r\n\r\n"],[1,"http.createServer(function(req, res){\r\n    \r\n    res.end('Channels count:' + channelsCount);\r\n    \r\n}).listen(process.env.PORT, process.env.IP)\r\n"]],"start1":1011,"start2":1011,"length1":12,"length2":157}]],"length":1168,"saved":false}
